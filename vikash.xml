<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title=" "
    description=""
	height="340"
    author="RajkUmar and VIkash"
    author_email="admin11@lodhagroup.in"
    author_location="Lodha Excelus,NM JOSHI MARG,Mumbai ....september252014444">

    <!-- Declare feature dependencies. -->

    <!-- This one is not specific to Gmail contextual gadgets. -->
    <Require feature="dynamic-height"/>
	<Require feature="opensocial-0.8" />
    <Require feature="oauthpopup" />
	
  
   
   
	 
	 <Require feature="google.contentmatch">
      <Param name="extractors">
        google.com:SenderEmailExtractor,google.com:SubjectExtractor,google.com:EmailBodyExtractor
      </Param>
    </Require>

  </ModulePrefs>
  <Content type="html" view="card">
    <![CDATA[
		<script src="https://apis.google.com/js/client.js?onload=checkAuth"></script>
		<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js'></script>
		<script type='text/javascript' src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
		<script type='text/javascript'>
		/***************************************************************************************************************/
		//Get the matched content from the email START
		/***************************************************************************************************************/
       // Fetch the array of content matches. 
        var matches = google.contentmatch.getContentMatches();
        var matchList = document.createElement('UL');
        var listItem;
        var extractedText;
		var email_id;
		var subject;
      var msg_id;
      var from_email;
      var cc_emails;
		var email_body;
		var allEmails ;
		var sep = "$$^";
		var MYcc_emails = "";
		var  mySenderEmails = "";
		
		alert("Before  new Gmail API Code:: "+ matches+"----"+matches.length)
		/*
		for (var key in matches[0]) {
		    alert(key + "- 0 -> " + matches[0][key]);
		}
		for (var key in matches[1]) {
		    alert(key + "- 1 -> " + matches[1][key]);
		}
		for (var key in matches[2]) {
		    alert(key + "- 2 -> " + matches[2][key]);
		}
		for (var key in matches[3]) {
		    alert(key + "- 3 -> " + matches[3][key]);
		}
		*/
		var i;
		for(i=0; i<matches.length; i++){
			for (var key in matches[i]) {
			    alert(key + "- "+i+" -> " + matches[i][key]);
			}
		}
		//*************$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ New code for call GMAIL API $$$$$$$$$$$$$$$$$$$$$$$$$$***************//
		//*************$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ New code for call GMAIL API $$$$$$$$$$$$$$$$$$$$$$$$$$***************//
        //<!-- Iterate through the array and display output for each match. -->
        for (var match in matches) {
			for (var key in matches[match]) {
				listItem = document.createElement('LI');
            			
              			//alert("Key-->"+key);
              			//alert("listItem-->"+listItem);
				 //extractedText1 = document.createTextNode(key + ": " + matches[match][key]);
				 ////if(key=="recipient_to_email")//sent mail DATA
				if( key =="sender_email")
				{
				inOutEmail =matches[match][key];
               			inOutEmail =  inOutEmail.replace(/\./g,'dot');
               			//inOutEmail =  inOutEmail.replace('.','dot');
               			//alert("inOutEmail-->"+inOutEmail);
				//==================================================================//
				email_id =matches[match][key];
               			email_id =  email_id.replace(/\./g,'dot');
               			email_id =  email_id.replace('.','dot');
               			//email_id = email_id.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);
               			//allEmails = email_id.concat(email_id);
               			//alert("sender_email-->email_id-->"+email_id);
               			//alert("RefErre-->"+document.referrer.split('#'));
				}
          			if(key == 'recipient_to_email')
                    		{
                   	
                    		from_email  =matches[match][key];
                    		from_email =  from_email.replace(/\./g,'dot');
               			from_email =  from_email.replace('.','dot');
               			mySenderEmails = mySenderEmails+from_email+";";
                     	//	from_email = from_email.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);
                     	//	alert(" recipient_to_email -->"+from_email);
                     		//allEmails = allEmails.concat(sep);
                     		alert("ALL EMAILS==>"+allEmails);
                     		getUserRole(from_email);
                    		}
                    		
            			if(key == 'recipient_cc_email')
                    		{
	                    	cc_emails  = matches[match][key];
	                        cc_emails = cc_emails.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);
	                        MYcc_emails = MYcc_emails+cc_emails+";";
	                        //MYcc_emails
	                        //alert("In recipient_cc_email-->"+MYcc_emails);
	                     //alert("after the expression from gadget rec_email111-->"+from_email);
	                     getUserRole(cc_emails);
	                    }
	                    //if(key == 'recipient_email')
                    	   //	{
                    	   //	recipient_email = matches[match][key];
                    	   //	recipient_email = recipient_email.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);
                    	   	alert("recipient_email-->"+recipient_email);
                    	   //	}
				if(key == "email_body")
				{
					email_body =matches[match][key]; 
				//	alert("email_body-->"+email_body);
				}
				if(key == "subject")
				{
					subject =matches[match][key];
					//alert("subject-->"+subject);
				}
            		if(key == 'message_id')
                    	{
                    	msg_id = matches[match][key];
                    	//alert("msg_id-->"+msg_id);
                	 }
            }
        }
		</script>

	<link rel="stylesheet" type="text/css" href="https://raw.githubusercontent.com/adminlodhagroup/email2caseuat/master/css/style.css">
	 <script type="text/javascript">
	function showDiv() {
   document.getElementById('welcomeDiv').style.display = "block";
}

	</script>
        <script type="text/javascript">
	function showExistingDiv() {
   document.getElementById('showExistingDiv').style.display = "block";
}

	</script>
	  
	
			<div id="wrapper">
    <div class="container">
        <form class="form-wrapper">
            <input type="text" id="search" placeholder="Type search text here ..." required>
            <input type="submit" value="Search" id="submit">
        </form>  
            <table class="bordered">
                                <thead>
                                    <tr>
                                        <th>Action</th>        
                                        <th>CRN</th>
                                        <th>Name</th>
                                        <th>RM Name</th>
                                        <th>Mobile No</th>
                                        <th>Project Name</th>
                                        <th>Wing</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                    <tr>
                                         <td><input type="radio" name="loginkeeping" id="loginkeeping" value="loginkeeping" /></td>
                                         <td>1210055 </td>
                                         <td>Lovely John </td>
                                         <td>Purnima Shetty</td>
                                       	 <td>9930066296</td>
                                         <td>CASA BELL GOLD</td>
                                         <td>Wing</td>
                                         <td>Booked Account</td>
                                   </tr>
                                   <tr>
                                         <td><input type="radio" name="loginkeeping" id="loginkeeping" value="loginkeeping" /></td>
                                         <td>1210055</td>
                                         <td>Lovely John </td>
                                         <td>Purnima Shetty</td>
                                       	 <td>9930066296</td>
                                         <td>CASA BELL GOLD</td>
                                         <td>Wing</td>
                                         <td>Booked Account</td>
                                   </tr>
                                   <tr>
                                         <td><input type="radio" name="loginkeeping" id="loginkeeping" value="loginkeeping" /></td>
                                         <td></td>
                                         <td></td>
                                         <td></td>
                                       	 <td ></td>
                                         <td></td>
                                         <td></td>
                                         <td></td>
                                 </tr>
                 </table>  
                 
                   <button  name="submit" class="submit act-button"  type="button"  value="Show Div" onclick="showDiv()" style="float:left!important; margin-right:20px;" >Create Case</button>
                   <button type="submit" name="submit" class="submit act-button" value="Show Div" onclick="showExistingDiv()" style="float:left!important; " >Add to Existing Case</button>
                   
                   
                   <div id="welcomeDiv"  style="display:none;" class="answer_list">
						    <div id="wrap">
							<div class="join"><img src="https://raw.githubusercontent.com/adminlodhagroup/email2caseuat/master/logo.png" width="192" height="90"/></div>
                            <div class="forms">
                             <form action="" method="get">
                             <ul>
                                 <li>
                                 <label>Communication Type </label>
                                     <input name="fullname" type="text" placeholder="Enter Communication Type ..." size="70" onClick="border: 1px solid #30a8da;"/></li>
                                 <li>
                                 <label>Interaction Mode  </label>
                                     <input name="email" type="text" placeholder="Enter Interaction Mode ..." size="70" onClick="border: 1px solid #30a8da;"/>
                                 </li>
                                  <li>
                                 <label>Interation Type </label>
                                     <select  onClick="border: 1px solid #30a8da;">
                                        <option value="None">-- None --</option>
                                        <option>Type1</option>
                                        <option>Type 2</option>
                                        <option>Type 3</option>
									</select>
                                  </li>
                                    <li>
                                 <label>Request Type </label>
                                      <select  onClick="border: 1px solid #30a8da;">
                                        <option value="None">-- None --</option>
                                        <option>Type1</option>
                                        <option>Type 2</option>
                                        <option>Type 3</option>
									</select>
                                    </li>
                                 <li>
                                 <label>Nature of request </label>
                                     <input name="email" type="text" placeholder="Enter Nature of request ..." size="70" onClick="border: 1px solid #30a8da;"/>
                                 </li>
                                  <li>
                                 <label>Dependency On Internal Functions</label>
                                      <select  onClick="border: 1px solid #30a8da;">
                                        <option value="None">-- None --</option>
                                        <option>Type1</option>
                                        <option>Type 2</option>
                                        <option>Type 3</option>
									</select>
                                  </li>
                                   <li>
                                 <label>Initial remarks </label>
                                     <input name="email" type="text" placeholder="Enter Initial remarks ..." size="70" onClick="border: 1px solid #30a8da;"/>
                                 </li>
                                  <li>
                                 <label>Request For L1</label>
                                     <select  onClick="border: 1px solid #30a8da;">
                                        <option value="None">-- None --</option>
                                        <option>Type1</option>
                                        <option>Type 2</option>
                                        <option>Type 3</option>
									</select>
                                  </li>
                                   <li>
                                 <label>Request For L2</label>
                                     <input name="password" type="text" placeholder="Enter Request For L2 ..." size="70" onClick="border: 1px solid #30a8da;"/>
                                  </li>
                                  
                                  <a class="create-acc" href="#">Submit</a>
                                  
                              </ul>
                              
                             </form>
                             </div>
						
</div>
</div>


  <div id="showExistingDiv"  style="display:none;" class="answer_list">
            <table class="bordered" id="component">
                       <!--         <thead>
                                    <tr>
                                        <th>Action</th>        
                                        <th>CRN</th>
                                        <th>Name</th>
                                        <th>RM Name</th>
                                        <th>Mobile No</th>
                                        <th>Project Name</th>
                                        <th>Wing</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>-->
                                    <tr>
                                         <td><input type="radio" name="loginkeeping" id="loginkeeping" value="loginkeeping" /></td>
                                         <td>01874895  </td>
                                         <td>Open </td>
                                         <td>1.71</td>
                                       	 <td>Transfers</td>
                                         <td>Customer Not contactable</td>
                                         <td>null</td>
                                          <td>07-06-2016,07:13Pm</td>
                                         <td> <button  name="submit" class="submit act-button"  type="button" >Attach</button></td>
                                   </tr>
                                   <tr>
                                         <td><input type="radio" name="loginkeeping" id="loginkeeping" value="loginkeeping" /></td>
                                         <td>01874895  </td>
                                         <td>Open </td>
                                         <td>1.71</td>
                                       	 <td>Transfers</td>
                                         <td>Customer Not contactable</td>
                                         <td>null</td>
                                          <td>07-06-2016,07:13Pm</td>
                                         <td> <button  name="submit" class="submit act-button"  type="button" >Attach</button></td>
                                   </tr>
                                   <tr>
                                         <td><input type="radio" name="loginkeeping" id="loginkeeping" value="loginkeeping" /></td>
                                         <td>01874895  </td>
                                         <td>Open </td>
                                         <td>1.71</td>
                                       	 <td>Transfers</td>
                                         <td>Customer Not contactable</td>
                                         <td>null</td>
                                          <td>07-06-2016,07:13Pm</td>
                                         <td> <button  name="submit" class="submit act-button"  type="button" >Attach</button></td>
                                 </tr>
                                   <tr>
                                         <td><input type="radio" name="loginkeeping" id="loginkeeping" value="loginkeeping" /></td>
                                         <td>01874895  </td>
                                         <td>Open </td>
                                         <td>1.71</td>
                                       	 <td>Transfers</td>
                                         <td>Customer Not contactable</td>
                                         <td>null</td>
                                          <td>07-06-2016,07:13Pm</td>
                                         <td> <button  name="submit" class="submit act-button"  type="button" >Attach</button></td>
                                 </tr>
                                   <tr>
                                         <td><input type="radio" name="loginkeeping" id="loginkeeping" value="loginkeeping" /></td>
                                         <td>01874895  </td>
                                         <td>Open </td>
                                         <td>1.71</td>
                                       	 <td>Transfers</td>
                                         <td>Customer Not contactable</td>
                                         <td>null</td>
                                          <td>07-06-2016,07:13Pm</td>
                                         <td> <button  name="submit" class="submit act-button"  type="button" >Attach</button></td>
                                 </tr>
                     
                 </table> 
                 </div>

    </div>
</div>
    ]]>
  </Content>
</Module>
